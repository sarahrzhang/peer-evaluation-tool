<p id="notice"><%= notice %></p>

<h1>Courses</h1>
<% if current_student %>
<h2>Student: <%= (Student.find(current_student.id)).email %></h2>
<% end %>
<% if current_instructor %>
<h2>Instructor: <%= (Instructor.find(current_instructor.id)).email %></h2>
<% end %>
<table class="table table-bordered">
  <thead>
    <tr>
      <th scope="col">Course Name</th>
      <th scope="col">Course ID</th>
      <th scope="col">Course Instructor</th>
      <th scope="col">Course Roster</th>
      <th scope="col">Semester</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <% if current_student %>
  <tbody>
    <% @courses.each do |course| %>
      <% Student.all.each do |studentTest| %>
      <% if course.students.any? { |current| current.email == studentTest.email } %>
      <% if studentTest.email == current_student.email %>
      <tr>
        
        <td><%= course.course_name %></td>
        <td><%= course.id %></td>
        <td>
        <% Instructor.all.each do |ins| %>
          <% if course.instructor_id == ins.id %>
            <%= ins.email + " " + ins.last_name%>
          <% end %>
        <% end %>
        </td>
        <td>
        <% Student.all.each do |student| %>
          <% if course.students.any? { |current| current.email == student.email } %>
              <%# if student.email == current_student.email %>
              <%= student.email + " " + student.last_name%>
              <br>
              <% #end %>
            
          <% end %>
        <% end %>
        </td>
        
        <td><%= course.semester %></td>
        <td><%= link_to 'Show', course, :class => "btn btn-primary" %></td>

      </tr>
      <% end %>
      <% end %>
      <% end %>
      
    <% end %>
  </tbody>
  <% end %>

  <% if current_instructor %>
  <tbody>
    <% @courses.each do |course| %>
      
      <% if course.instructor_id == current_instructor.id %>
      <tr>
        
        <td><%= course.course_name %></td>
        <td><%= course.id %></td>
        <td>
        <% Instructor.all.each do |ins| %>
          <% if course.instructor_id == ins.id %>
            <%= ins.email + " " + ins.last_name%>
          <% end %>
        <% end %>
        </td>
        <td>
        <% Student.all.each do |student| %>
          <% if course.students.any? { |current| current.email == student.email } %>
              <%# if student.email == current_student.email %>
              <%= student.email + " " + student.last_name%>
              <br>
              <% #end %>
            
          <% end %>
        <% end %>
        </td>
        
        <td><%= course.semester %></td>
        <td><%= link_to 'Show', course, :class => "btn btn-primary btn-sm" %></td>
        <td><%= link_to 'Edit', edit_course_path(course), :class => "btn btn-primary btn-sm" %></td>
        <td><%= link_to 'Delete', course, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-primary btn-sm" %></td>
      </tr>
      
      <% end %>
      
    <% end %>
  </tbody>
  <% end %>
</table>

<br>

<% if current_instructor %>
<%= link_to 'New Course', new_course_path, :class => "btn btn-primary btn-sm" %>
<% end %>
<%= link_to 'Back', root_path, :class => "btn btn-primary btn-sm" %>